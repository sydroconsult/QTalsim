<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Step by Step &#8212; QTalsim 1.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=89b800e6" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=3d533f9b"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Connect to Talsim DB" href="doc_connect_to_db.html" />
    <link rel="prev" title="Getting Started with HRUs" href="hrus_getting_started.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="doc_connect_to_db.html" title="Connect to Talsim DB"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="hrus_getting_started.html" title="Getting Started with HRUs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">QTalsim 1.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="doc_qtalsim.html" accesskey="U">HRU calculation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Step by Step</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="step-by-step">
<h1>Step by Step<a class="headerlink" href="#step-by-step" title="Permalink to this heading">¶</a></h1>
<section id="select-sub-basin-layer">
<span id="id1"></span><h2>Select Sub-basin Layer<a class="headerlink" href="#select-sub-basin-layer" title="Permalink to this heading">¶</a></h2>
<blockquote id="id2">
<div><p>First, select the layer containing the sub-basins from the
drop-down-menu that lists all polygon layers in your current QGIS
project. Confirm your selection by clicking on the ‘Confirm
Sub-basins’-Button. Upon clicking this button the Sub-basin layer
is selected, and overlapping features and duplicates are removed.
You can inspect the result in your QGIS project (layer
‘Sub-basins’).</p>
<p>After selecting the sub-basin layer’s fields containing 1) the
unique identifier and 2) the slope values must be selected from
the drop-down menu. These fields are utilized in the final
EFL-layer and serve as input parameters to Talsim.</p>
<p><img alt="Select Sub-basin" src="_images/SelectSubBasin.png" /></p>
</div></blockquote>
</section>
<section id="select-edit-soil-layer">
<h2>Select &amp; Edit Soil Layer<a class="headerlink" href="#select-edit-soil-layer" title="Permalink to this heading">¶</a></h2>
<blockquote id="select-and-edit-soil-layer">
<div><ul>
<li><p><strong>Select Soil Layer</strong></p>
<p>Choose the soil layer from the drop-down menu and confirm your
selection by clicking ‘Confirm Soil’. Upon doing so, all valid
geometries of this layer are selected and clipped to match the
boundaries of the Sub-basin layer. During this step duplicate
geometries are removed from the layer and the soil mapping
table is populated with the fields of the soil layer.</p>
</li>
<li><p><strong>Soil Mapping</strong></p>
<p>This table contains Talsim soil parameters in the first column
and all the field names of the soil layer in drop-down menus in
the second column. In this step, users are required to map each
Talsim parameter to its corresponding field in the soil layer.
The table below shows the necessary type for these parameters.
If the user-mapped field has a different datatype, the plugin,
where possible, converts the field’s values to the parameter’s
type. If ‘Parameter not available’ is selected, that parameter
will be added with null values.</p>
<p>To finalize the soil mapping, click ‘Confirm Soil Mapping’.
This creates a new layer, containing all fields from the soil
layer and all parameters from the soil mapping table, assigned
with values from their corresponding fields. If there is a
datatype mismatch between the soil layer’s field and the
parameter, a warning is logged.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ID_Soil</p></td>
<td><p>int</p></td>
</tr>
<tr class="row-odd"><td><p>NameSoil</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-odd"><td><p>BulkDensityClass</p></td>
<td><p>int</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>int</p></td>
</tr>
<tr class="row-odd"><td><p>WiltingPoint</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-even"><td><p>FieldCapacity</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-odd"><td><p>TotalPoreVolume</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-even"><td><p>KfValue</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-odd"><td><p>MaxInfiltration</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-even"><td><p>MaxCapillarySuction</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-odd"><td><p>LayerThickness1</p></td>
<td><p>float</p></td>
</tr>
</tbody>
</table>
<p><img alt="Select and Edit Soil Layer" src="_images/SelectandEditSoilLayer.png" /></p>
</li>
<li><p><strong>Optional Soil Editing Steps</strong></p>
<p>Before finalizing the soil layer, users have the option to
perform some editing steps. Please refer to section <a class="reference external" href="#optional-editing-steps">Optional
Editing Steps</a> below for a detailed
explanation of ‘Check for Overlapping Features’, ‘Delete
Overlapping Features’, ‘Check for Gaps’ and ‘Fill Gaps’.</p>
<p>In addition to the option of deleting all overlapping parts
(using button ‘Delete Overlapping Features’), you can also
selectively remove specific overlapping soil features. This can
be done via the table that populates when you click ‘Check for
Overlapping Features’. This table displays all overlapping soil
features across two columns. For each pair of overlapping
features, you can decide, which feature’s geometry should stay
unchanged, and which should have its overlapping part removed
from its geometry. In the third column, you can select features
to highlight them in the soil layer, allowing for easy viewing.
After you have identified all the unwanted overlapping parts,
simply press ‘Delete overlapping part of selected Features’ to
remove the overlapping parts from the selected features.</p>
<p><img alt="Optional Soil Layer Steps" src="_images/optionalStepsSoilLayer.png" /></p>
</li>
<li><p><strong>Create Soil Layer</strong></p>
<p>This step dissolves the layer according to the Talsim
parameters, removes the fields that are not required for Talsim
and creates the soil layer used for the intersection.</p>
</li>
</ul>
</div></blockquote>
</section>
<section id="select-and-edit-land-use-layer">
<h2>Select and Edit Land use layer<a class="headerlink" href="#select-and-edit-land-use-layer" title="Permalink to this heading">¶</a></h2>
<blockquote id="select-and-edit-landuse-layer">
<div><ul>
<li><p><strong>Select Land use Layer</strong></p>
<p>First, select the land use layer from the drop-down menu and
confirm your selection by clicking ‘Confirm Layer’. Upon doing
so, all valid geometries of this layer are selected and clipped
to align with the boundaries of the sub-basin layer. During
this process, any duplicate geometries within the layer are
also removed. After confirming the layer, you must then select
the field containing the land use types and confirm this
selection by clicking ‘Confirm Field’. The unique land use
types identified here will be used in a subsequent step.</p>
<p><img alt="Select Land use Layer" src="_images/SelectLanduseLayer.png" /></p>
</li>
<li><p><strong>Upload Talsim Land use Names and Parameters</strong></p>
<p>The user must upload a CSV-file that includes the Talsim land
use types and their associated parameter values. This can be
done by by clicking ‘Select CSV-File’, which allows the user to
choose the CSV-file. It is important to select the correct
delimiter for the file. After uploading, users can check the
parameters by reviewing the QTalsim-Log.</p>
<p><img alt="CSV-File Land use" src="_images/CSVFile_Landuse.png" /> <img alt="Upload CSV-File" src="_images/UploadCSVFile.png" /></p>
</li>
<li><p><strong>Land use Mapping</strong></p>
<p>When you click on ‘Start Landuse Mapping’, the land use mapping
table will be populated with all unique land use types from the
layer in the first column. In the second column, a
dropdown-menu with all Talsim fields of the CSV-file will
appear. Here, you must match each land use type from your data
(in the first column) with the corresponding Talsim land use
type (in the second column). For convenience, the second column
is automatically prefilled with Talsim land use types that have
the same name in the layer and the CSV-file. After completing
the mapping, click ‘Confirm Landuse Mapping’ to create a new
layer containing the input fields from your layer and the
Talsim parameter values, as specified in the CSV-file.</p>
<p><img alt="Land use Mapping" src="_images/LanduseMapping.png" /></p>
</li>
<li><p><strong>Optional Editing Steps for Land use Layer</strong></p>
<p>After confirming the land use mapping you have the option to
perform additional editing steps, such as deleting overlapping
features and filling gaps. For more detailed information on
these steps, please refer to section <a class="reference external" href="#optional-editing-steps">Optional Editing
Steps</a>.</p>
<p>In addition to the option of deleting all overlapping parts
(using button ‘Delete Overlapping Features’), you can also
selectively remove specific overlapping landuse features. This
can be done via the table that populates when you click ‘Check
for Overlapping Features’. This table displays all overlapping
landuse features across two columns. For each pair of
overlapping features, you can decide, which feature’s geometry
should stay unchanged, and which should have its overlapping
part removed from its geometry. In the third column, you can
select features to highlight them in the landuse layer,
allowing for easy viewing. After you have identified all the
unwanted overlapping parts, simply press ‘Delete overlapping
part of selected Features’ to remove the overlapping parts from
the selected features.</p>
<p><img alt="Optional Steps Land Use Layer" src="_images/optionalStepsLanduseLayer.png" /></p>
</li>
<li><p><strong>Create Land use Layer</strong></p>
<p>Clicking ‘Create Land Use Layer’ dissolves the layer according
to the Talsim parameters, removes any fields that are not
required for Talsim and generates the land use layer that will
be used for intersection.</p>
<p><img alt="Create Land use Layer" src="_images/CreateLanduseLayer.png" /></p>
</li>
</ul>
</div></blockquote>
</section>
<section id="intersection-of-layers">
<h2>Intersection of Layers<a class="headerlink" href="#intersection-of-layers" title="Permalink to this heading">¶</a></h2>
<blockquote id="intersection-layers">
<div><p>This step results in the creation of the files: BOD, BOA, LNZ and
EFL, which can be used as input files for Talsim. To generate the
HRUs, the three layers (sub-basins, soil and land use) are
intersected in a first step. The user can set a minimum size of
the HRUs [m²] and a minimum percentage of HRUs relative to the
sub-basin’s area. HRUs that fall below the specified size or
percentage share are deleted and filled using the
‘Eliminate’-tool. You can select the elimination-mode from the
drop-down menu (find further information
<a class="reference external" href="https://docs.qgis.org/3.28/en/docs/user_manual/processing_algs/qgis/vectorgeometry.html?highlight=eliminate#eliminate-selected-polygons">here</a>).</p>
<p>Gaps within the sub-basin layer are left unfilled, while all other
gaps are appropriately filled. Any overlapping features within the
resulted intersected layer are removed.</p>
<p><img alt="Intersect Layers" src="_images/Intersection.png" /></p>
<p>The resulting layers are then automatically added to the current
QGIS project.</p>
</div></blockquote>
</section>
<section id="save-layers-as-ascii-files-geopackage">
<h2>Save Layers as ASCII-Files &amp; Geopackage<a class="headerlink" href="#save-layers-as-ascii-files-geopackage" title="Permalink to this heading">¶</a></h2>
<blockquote id="save-layers-to-geopackage">
<div><p>In the final step, users have the option to export layers as ASCII files.
Exporting ASCII files allows for the layers to be saved in a format compatible with Talsim NG4.
To begin, users must select the ‘Select Output Folder’ option and choose an appropriate folder.
This folder will be designated for both the ASCII files and the geopackage export.
Once the folder is chosen, users can proceed by clicking ‘Export ASCII Files’ and
entering a preferred name for the ASCII files. These files will then be exported with
the corresponding extensions (.EFL, .BOD, .BOA, .LNZ). By clicking ‘Ok’, the layers are
stored in a geopackage under a name specified by the user.</p>
<p><img alt="Final Steps" src="_images/FinalSteps.png" /></p>
</div></blockquote>
</section>
<section id="optional-editing-steps">
<h2>Optional Editing Steps<a class="headerlink" href="#optional-editing-steps" title="Permalink to this heading">¶</a></h2>
<blockquote id="id3">
<div><p>For both the soil layer and the land use layer, the user has the
option to perform additional editing steps.</p>
<ul>
<li><p><strong>Check for Overlapping Features</strong></p>
<p>This function checks for overlapping features within the layer. It
identifies features that are either partially or completely
overlapping. The feature-IDs of the overlapping features are
logged to the QTalsim-Log. Additionally, a layer named ‘Layer with
overlapping features’ is added to the QGIS project. You can then
inspect the overlapping features by reviewing this layer’s
attribute table by searching for the overlapping feature IDs.</p>
<p><img alt="Check for overlapping Features" src="_images/CheckOverlappingFeatures.png" /></p>
</li>
<li><p><strong>Delete Overlapping Features</strong></p>
<p>This function removes all overlapping parts of a layer. If two
polygons overlap, the overlapping part is assigned to the smaller
of the two polygons.</p>
</li>
<li><p><strong>Check for Gaps</strong></p>
<p>This function checks for gaps in the soil/land use layer. It
identifies not only gaps within the layer itself but also gaps
that occur along the boundary of the sub-basin layer. A separate
layer, which includes all detected gaps from the soil or land use
layer, is then added to the QGIS project. This allows the user to
inspect and analyze these gaps more closely.</p>
</li>
<li><p><strong>Fill Gaps</strong></p>
<p>This function fills all detected gaps in the layer using the
Eliminate-tool. You can specify the elimination-mode from a
drop-down menu (find further information
<a class="reference external" href="https://docs.qgis.org/3.28/en/docs/user_manual/processing_algs/qgis/vectorgeometry.html?highlight=eliminate#eliminate-selected-polygons">here</a>).
The result of this step is a layer free of gaps and matching the
extent of the sub-basin layer.</p>
</li>
</ul>
</div></blockquote>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Step by Step</a><ul>
<li><a class="reference internal" href="#select-sub-basin-layer">Select Sub-basin Layer</a></li>
<li><a class="reference internal" href="#select-edit-soil-layer">Select &amp; Edit Soil Layer</a></li>
<li><a class="reference internal" href="#select-and-edit-land-use-layer">Select and Edit Land use layer</a></li>
<li><a class="reference internal" href="#intersection-of-layers">Intersection of Layers</a></li>
<li><a class="reference internal" href="#save-layers-as-ascii-files-geopackage">Save Layers as ASCII-Files &amp; Geopackage</a></li>
<li><a class="reference internal" href="#optional-editing-steps">Optional Editing Steps</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="hrus_getting_started.html"
                          title="previous chapter">Getting Started with HRUs</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="doc_connect_to_db.html"
                          title="next chapter">Connect to Talsim DB</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/hrus_step_by_step.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="doc_connect_to_db.html" title="Connect to Talsim DB"
             >next</a> |</li>
        <li class="right" >
          <a href="hrus_getting_started.html" title="Getting Started with HRUs"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">QTalsim 1.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="doc_qtalsim.html" >HRU calculation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Step by Step</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Sydro Consult GmbH.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    </div>
  </body>
</html>